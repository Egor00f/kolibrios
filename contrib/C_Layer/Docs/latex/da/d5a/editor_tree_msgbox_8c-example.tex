\doxysection{editor\+\_\+tree\+\_\+msgbox.\+c}
\hypertarget{editor_tree_msgbox_8c-example}{}\label{editor_tree_msgbox_8c-example}
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ KolibriGUI\ demobox}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ -\/Editor\ (multiline\ edit)}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ -\/TreeView}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ -\/MsgBox\ Dialog}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ Free\ for\ all}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ Initially\ written\ by\ Siemargl,\ 2016}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ ToDo}}
\DoxyCodeLine{\textcolor{comment}{*/}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <assert.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}kos32sys.h"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{kolibri__gui_8h}{kolibri\_gui.h}}"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{kolibri__libimg_8h}{kolibri\_libimg.h}}"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{kolibri__msgbox_8h}{kolibri\_msgbox.h}}"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{/*extern\ inline\ scrollbar*\ kolibri\_scrollbar(scrollbar*\ sb,\ uint32\_t\ x\_w,\ uint32\_t\ y\_h,\ uint32\_t\ btn\_height,\ uint32\_t\ max\_area,}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ uint32\_t\ cur\_area,\ uint32\_t\ position,\ uint32\_t\ back\_color,\ uint32\_t\ front\_color,\ uint32\_t\ line\_color);}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{extern\ inline\ scrollbar*\ kolibri\_new\_scrollbar(uint32\_t\ x\_w,\ uint32\_t\ y\_h,\ uint32\_t\ btn\_height,\ uint32\_t\ max\_area,}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ uint32\_t\ cur\_area,\ uint32\_t\ position,\ uint32\_t\ back\_color,\ uint32\_t\ front\_color,\ uint32\_t\ line\_color);}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{extern\ inline\ scrollbar*\ kolibri\_new\_scrollbar\_def(uint32\_t\ x\_w,\ uint32\_t\ y\_h,\ uint32\_t\ max\_area,\ uint32\_t\ cur\_area,\ uint32\_t\ position);}}
\DoxyCodeLine{\textcolor{comment}{*/}}
\DoxyCodeLine{\textcolor{keywordtype}{char}\ run\_path[4096];}
\DoxyCodeLine{\textcolor{keywordtype}{char}\ fname[4096];}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{char}*\ \ \ load\_file\_inmem(\textcolor{keywordtype}{char}*\ fname,\ int32\_t*\ read\_sz);\ \textcolor{comment}{//\ see\ below}}
\DoxyCodeLine{\textcolor{keywordtype}{char}*\ \ \ load\_image\_file(\textcolor{keywordtype}{char}*\ fname);\ \textcolor{comment}{//\ see\ below}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ set\_os\_keyb\_mode(\textcolor{keywordtype}{int}\ mode)}
\DoxyCodeLine{\textcolor{comment}{//\ 0\ -\/\ ASCII,\ 1\ -\/\ SCAN}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \_\_asm\_\_\ \mbox{\hyperlink{kolibri__editor_8h_a6d952a8d068aaf8ee03623416d163a37}{\_\_volatile\_\_}}(}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}int\ \$0x40"{}}}
\DoxyCodeLine{\ \ \ \ ::\textcolor{stringliteral}{"{}a"{}}(66),\ \textcolor{stringliteral}{"{}b"{}}(1),\ \textcolor{stringliteral}{"{}c"{}}(mode));}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}\ **argv)}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{/*\ Load\ all\ libraries,\ initialize\ global\ tables\ like\ system\ color\ table\ and}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ operations\ table.\ kolibri\_gui\_init()\ will\ EXIT\ with\ mcall\ -\/1\ if\ it\ fails}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ to\ do\ it's\ job.\ This\ is\ all\ you\ need\ to\ call\ and\ all\ libraries\ and\ GUI}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ elements\ can\ be\ used\ after\ a\ successful\ call\ to\ this\ function}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{kolibri__gui_8h_a8b904ab02df6cc248ac2a4cbb33295c3}{kolibri\_gui\_init}}();}
\DoxyCodeLine{\ \ \ \ set\_os\_keyb\_mode(1);\ \textcolor{comment}{//\ scan\ code\ mode\ needed\ for\ editor}}
\DoxyCodeLine{\textcolor{comment}{//\ \ \ \ kolibri\_proclib\_init();\ \ //\ opensave\ \&\&\ color\ dialogs}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{kolibri__libimg_8h_a48d1fa50e5dd5ae820b4a05b4a59b939}{kolibri\_libimg\_init}}();\ \ \textcolor{comment}{//\ png\ handling}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ gui\_event\ =\ \mbox{\hyperlink{kolibri__gui_8h_a97735f796c03253d408c7e5bdf5f37dca0a84f1803dcad15708cd5bf208a8118a}{KOLIBRI\_EVENT\_REDRAW}};}
\DoxyCodeLine{\ \ \ \ uint32\_t\ pressed\_button\ =\ 0;}
\DoxyCodeLine{\textcolor{comment}{//\ \ \ \ uint32\_t\ mouse\_button;}}
\DoxyCodeLine{\textcolor{comment}{//\ \ \ \ pos\_t\ \ \ mouse\_pos;}}
\DoxyCodeLine{\textcolor{comment}{//\ \ \ \ oskey\_t\ keypress;}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ make\ full\ path\ +\ argv}}
\DoxyCodeLine{\ \ \ \ strcpy(run\_path,\ argv[0]);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{char}\ *pc\ =\ strrchr(run\_path,\ \textcolor{charliteral}{'/'});\ \ \textcolor{comment}{//\ this\ fails\ if\ has\ params\ with\ '/'\ within.\ use\ argv[0]\ instead}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (pc)\ pc[1]\ =\ 0;}
\DoxyCodeLine{\textcolor{comment}{//\ \ \ \ debug\_board\_write\_str(temp\_path);}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ creating\ GUI\ using\ library\ functions}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{structkolibri__window}{kolibri\_window}}\ *main\_window\ =\ \mbox{\hyperlink{kolibri__gui__elements_8h_a62aa1b7d35feb27a0a4cc4cd909e8cb2}{kolibri\_new\_window}}(50,\ 40,\ 490,\ 500,\ \textcolor{stringliteral}{"{}Editor,\ TreeView\ and\ MsgBox\ demo"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{kolibri__editor_8h_a017f88c6e085eda98f9d3e0f2aebb68e}{editor}}\ *ed;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ *ed\_lock;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ gui\_add\_editor(main\_window,\ ed\ =\ kolibri\_new\_editor(\mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(0,\ 440),\ \mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(20,\ 150),\ 0x11,\ 2048,\ \&ed\_lock));\ \ \textcolor{comment}{//\ 0x11\ font\ 8x16\ sized\ x2}}
\DoxyCodeLine{\ \ \ \ ed\_lock\ =\ ed;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ load\ sample\ file}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//int\ res,\ len;}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//res\ =\ editor\_openfile(ed,\ "{}/sys/boardlog.txt"{},\ \&len);}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//debug\_board\_printf("{}loaded\ sample\ file\ err=\%d,\ len=\%d\(\backslash\)n"{},\ res,\ len);}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//adding\ sample\ text\ @cursor}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{char}\ *sampletext\ =\ \textcolor{stringliteral}{"{}*123*=========ADDED\ SAMPLE\ TEXT=========*789*\(\backslash\)n"{}};}
\DoxyCodeLine{\ \ \ \ (*ted\_text\_add)(ed,\ sampletext,\ strlen(sampletext),\ 0);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ treelist\ as\ tree}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{kolibri__treelist_8h_a5622589e29e2a248a53061094e0a3524}{treelist}}\ *tl\ =\ kolibri\_new\_treelist(\mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(0,\ 200),\ \mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(200,\ 200),\ 16,\ \mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(16,\ 16),\ 100,\ 50,\ 0,\ 0,\ \textcolor{comment}{/*TL\_KEY\_NO\_EDIT\ |*/}\ \mbox{\hyperlink{kolibri__treelist_8h_a912844fe2bb4ed14b19eaf65a1d30868aace99615ff762edc50c08609006283b5}{TL\_DRAW\_PAR\_LINE}},\ \&ed\_lock,\ 0x8080ff,\ 0x0000ff,\ 0xffffff);}
\DoxyCodeLine{\ \ \ \ (*tl\_data\_init)(tl);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}}}
\DoxyCodeLine{\ \ \ \ strcpy(fname,\ run\_path);}
\DoxyCodeLine{\ \ \ \ strcat(fname,\ \textcolor{stringliteral}{"{}tl\_sys\_16.png"{}});}
\DoxyCodeLine{\ \ \ \ tl-\/>data\_img\_sys\ =\ load\_image\_file(fname);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}}}
\DoxyCodeLine{\ \ \ \ strcpy(fname,\ run\_path);}
\DoxyCodeLine{\ \ \ \ strcat(fname,\ \textcolor{stringliteral}{"{}tl\_nod\_16.png"{}});}
\DoxyCodeLine{\ \ \ \ tl-\/>data\_img\ =\ load\_image\_file(fname);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node1"{}},\ 1,\ 0,\ 0);\ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}\ 1\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}}}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node1.1"{}},\ 1,\ 0,\ 1);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node1.1.1"{}},\ 0,\ 0,\ 2);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node1.2"{}},\ 1,\ 0,\ 1);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node2"{}},\ 1,\ 1,\ 0);\ \ \textcolor{comment}{//\ closed\ node}}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node2.1"{}},\ 1,\ 0,\ 1);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl,\ \textcolor{stringliteral}{"{}node3"{}},\ 1,\ 0,\ 0);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_beg)(tl);\ \textcolor{comment}{//;{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}}}
\DoxyCodeLine{\ \ \ \ gui\_add\_treelist(main\_window,\ tl);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ treelist\ as\ listbox,\ no\ caption,\ no\ icons}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{kolibri__treelist_8h_a5622589e29e2a248a53061094e0a3524}{treelist}}\ *tl2\ =\ kolibri\_new\_treelist(\mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(220,\ 200),\ \mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(200,\ 200),\ 0,\ \mbox{\hyperlink{kolibri__gui__elements_8h_a1392177b848ade0c5e3f62f759a283b3}{X\_Y}}(16,\ 16),\ 100,\ 50,\ 0,\ 0,\ \mbox{\hyperlink{kolibri__treelist_8h_a912844fe2bb4ed14b19eaf65a1d30868ae1718248cd6c22e0fa27d431726f8440}{TL\_LISTBOX\_MODE}},\ \&ed\_lock,\ 0x8080ff,\ 0x0000ff,\ 0xffffff);}
\DoxyCodeLine{\ \ \ \ (*tl\_data\_init)(tl2);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ tl-\/>col\_zag\ |=\ 0x10000000;\ //\ 0x10\ in\ txt\ color\ must\ give\ font\ 9x16,\ but\ this\ not\ work,\ only\ 6x8\ font\ (}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ tl2-\/>data\_img\_sys\ =\ tl-\/>data\_img\_sys;}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//tl2-\/>data\_img\ =\ tl-\/>data\_img;\ -\/\ no\ icons\ will\ be\ drawed}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl2,\ \textcolor{stringliteral}{"{}list1"{}},\ 0,\ 0,\ 0);\ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}\ 1\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}}}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl2,\ \textcolor{stringliteral}{"{}list2"{}},\ 0,\ 0,\ 0);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ treelist\_node\_add(tl2,\ \textcolor{stringliteral}{"{}list3"{}},\ 0,\ 0,\ 0);}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_next)(tl2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ (*tl\_cur\_beg)(tl2);\ \textcolor{comment}{//;{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}}}
\DoxyCodeLine{\ \ \ \ gui\_add\_treelist(main\_window,\ tl2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{kolibri__msgbox_8h_a9976a6476044d5ef24d9ec5988ef1059}{msgbox}}*\ box\ =\ kolibri\_new\_msgbox(\textcolor{stringliteral}{"{}Exit"{}},\ \textcolor{stringliteral}{"{}Are\(\backslash\)rYOU\(\backslash\)rSure?"{}},\ 3,\ \textcolor{stringliteral}{"{}YES"{}},\ \textcolor{stringliteral}{"{}Absolute"{}},\ \textcolor{stringliteral}{"{}Not\ Yet"{}},\ NULL);\ \ \textcolor{comment}{//\ default\ NOT}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ oskey\_t\ \mbox{\hyperlink{kolibri__editor_8h_a6efc9555d65f172040066b7da1e3d2a0}{key}};}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{do}\ \ \textcolor{comment}{/*\ Start\ of\ main\ activity\ loop\ */}}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(gui\_event)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{kolibri__gui_8h_a97735f796c03253d408c7e5bdf5f37dca0a84f1803dcad15708cd5bf208a8118a}{KOLIBRI\_EVENT\_REDRAW}}:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (box-\/>retval\ ==\ 1\ ||\ box-\/>retval\ ==\ 2)\ \textcolor{keywordflow}{goto}\ clearing;\ \ \textcolor{comment}{//\ msgbox\ closes}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{kolibri__gui_8h_a81a1ea83d66ffc14350b4b72b078a3ef}{kolibri\_handle\_event\_redraw}}(main\_window);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{kolibri__gui_8h_a97735f796c03253d408c7e5bdf5f37dca2dbec864e4e963d6bea9954806521df2}{KOLIBRI\_EVENT\_NONE}}:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{kolibri__gui_8h_a97735f796c03253d408c7e5bdf5f37dca563a416dc7f301d71a631da21a3963aa}{KOLIBRI\_EVENT\_KEY}}:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{kolibri__editor_8h_a6efc9555d65f172040066b7da1e3d2a0}{key}}\ =\ get\_key();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ed\_lock\ ==\ ed)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ editor\_key(ed,\ \mbox{\hyperlink{kolibri__editor_8h_a6efc9555d65f172040066b7da1e3d2a0}{key}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(ed\_lock\ ==\ tl)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ treelist\_key(tl,\ \mbox{\hyperlink{kolibri__editor_8h_a6efc9555d65f172040066b7da1e3d2a0}{key}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(ed\_lock\ ==\ tl2)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ treelist\_key(tl2,\ \mbox{\hyperlink{kolibri__editor_8h_a6efc9555d65f172040066b7da1e3d2a0}{key}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{kolibri__gui_8h_a90720148918d989921c1572058d21a58}{kolibri\_handle\_event\_key}}(main\_window,\ \mbox{\hyperlink{kolibri__editor_8h_a6efc9555d65f172040066b7da1e3d2a0}{key}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{kolibri__gui_8h_a97735f796c03253d408c7e5bdf5f37dca775f06d5461504664e4a97428e9d7a2e}{KOLIBRI\_EVENT\_BUTTON}}:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ pressed\_button\ =\ get\_os\_button();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (pressed\_button)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{kolibri__gui_8h_a5fb27a09574b3a8473fac0e17075675c}{BTN\_QUIT}}:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (box-\/>retval\ ==\ 3\ ||\ box-\/>retval\ ==\ 0)\ \textcolor{comment}{//\ not\ started\ or\ cancelled,\ analyze\ when\ redraw\ after\ closing\ msgbox}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kolibri\_start\_msgbox(box,\ NULL);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{kolibri__gui_8h_a97735f796c03253d408c7e5bdf5f37dca3e55219fb3a0deaa00798ad87e12a401}{KOLIBRI\_EVENT\_MOUSE}}:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{kolibri__gui_8h_a5970422747362f11880a68439b7ef870}{kolibri\_handle\_event\_mouse}}(main\_window);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ gui\_event\ =\ get\_os\_event();}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{while}(1)\ ;\ \textcolor{comment}{/*\ End\ of\ main\ activity\ loop\ */}}
\DoxyCodeLine{}
\DoxyCodeLine{clearing:}
\DoxyCodeLine{trap(0x55);\ \textcolor{comment}{//\ for\ stop\ in\ debug}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//res\ =\ editor\_savefile(ed,\ "{}/tmp0/1/editorlog.txt"{});}}
\DoxyCodeLine{\ \ \ \ pc\ =\ editor\_get\_text(ed);}
\DoxyCodeLine{\ \ \ \ debug\_board\_printf(\textcolor{stringliteral}{"{}saved\ text\ \(\backslash\)"{}\%s\(\backslash\)"{}\(\backslash\)n"{}},\ pc);}
\DoxyCodeLine{\ \ \ \ free(pc);}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ editor\_delete(ed);}
\DoxyCodeLine{\ \ \ \ treelist\_data\_clear(tl);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{char}*\ \ \ load\_file\_inmem(\textcolor{keywordtype}{char}*\ fname,\ int32\_t*\ read\_sz)}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ FILE\ *f\ =\ fopen(fname,\ \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (!f)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ debug\_board\_printf(\textcolor{stringliteral}{"{}Can't\ open\ file:\ \%s"{}},\ fname);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (fseek(f,\ 0,\ SEEK\_END))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ debug\_board\_printf(\textcolor{stringliteral}{"{}Can't\ SEEK\_END\ file:\ \%s"{}},\ fname);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ filesize\ =\ ftell(f);}
\DoxyCodeLine{\ \ \ \ rewind(f);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{char}*\ fdata\ =\ malloc(filesize);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}(!fdata)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ debug\_board\_printf(\textcolor{stringliteral}{"{}No\ memory\ for\ file\ \%s"{}},\ fname);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ *read\_sz\ =\ fread(fdata,\ 1,\ filesize,\ f);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (ferror(f))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ debug\_board\_printf(\textcolor{stringliteral}{"{}Error\ reading\ file\ \%s"{}},\ fname);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ fclose(f);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ fdata;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{char}*\ \ \ load\_image\_file(\textcolor{keywordtype}{char}*\ fname)}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ int32\_t\ \ \ \ \ read\_bytes\ =\ -\/1,\ w,\ h;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{char}\ \ \ \ *image\_data\ =\ 0,\ *image\_data\_rgb\ =\ 0,\ *filedata\ =\ 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ filedata\ =\ load\_file\_inmem(fname,\ \&read\_bytes);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ image\_data}}
\DoxyCodeLine{\ \ \ \ image\_data\ =\ (*img\_decode)(filedata,\ read\_bytes,\ 0);}
\DoxyCodeLine{\ \ \ \ w\ =\ *(\textcolor{keywordtype}{int}*)(image\_data\ +4);}
\DoxyCodeLine{\ \ \ \ h\ =\ *(\textcolor{keywordtype}{int}*)(image\_data\ +8);}
\DoxyCodeLine{\ \ \ \ image\_data\_rgb\ =\ malloc(w\ *\ h\ *\ 3);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ rgb}}
\DoxyCodeLine{\ \ \ \ (*img\_to\_rgb2)(image\_data,\ image\_data\_rgb);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ {\ucr}{\ucr}{\ucr}{\ucr}{\ucr}\ image\_data}}
\DoxyCodeLine{\ \ \ \ (*img\_destroy)(image\_data);}
\DoxyCodeLine{\ \ \ \ free(filedata);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ image\_data\_rgb;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}

\end{DoxyCodeInclude}
 